---
title: "Datalicious Depths of Delectable Data "
output: html_document
date: "2023-08-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(tidyverse)
library(dplyr)
library(plotly)
library(ggplot2)
library(distill)
library(rmarkdown)
library(RColorBrewer)
library(formattable)

# Learn more about creating websites with Distill at:
# https://rstudio.github.io/distill/website.html

```

Want to jump to a specific question? 

- [What is the most popular result? ](#popres)
- [Do results vary between countries?](#country) 
- [Are all questions created equal?] 

### What is the most popular result? <a name="popres"></a>

Unfortunately, within this data set, Open Psychometrics did not provide us with specific results (e.g. SCUEI), but with a bunch of numbers. In fact, this is what the data looks like: 


```{r, initialdata, include=FALSE}
data <- read.csv("data-final.csv")
data[] <- sapply(data, as.numeric)
options(scipen=10000) 
```

```{r, begin data}
paged_table(head(select(data, EXT1, EXT2, EXT3)))
```


I've only selected the first 3 columns of the first 6 responses. Not too bad, right? But, you've gotta imagine about 50 more columns, and about a million more rows. It's a little more intimidating now, but we've gotta start somewhere >:)

First, let's calculate the scores for the Extroversion personality trait. We can do this by summing up the scores of the 10 EXT (standing for EXTroversion) questions. Of course, it should be noted that answering a '4' or '5' on a EXT question doesn't always mean that a user is more extroverted. For example, EXT Question 2: I don't talk a lot vs EXT Question 1: I am the life of the party. 

So, we'll need to make sure to add and subtract scores as necessary - I've arbitrarily made the decision to add 'points' if a question symbolizes extroversion, while subtracting 'points' if a question is correlated with introversion. 

Hence, after adding up all the scores, any positive score (> 0) will mean that the user receives an 'S' for Sociable, while a negative score (< 0) would result in an 'R'. If their score is 0, then they'd receive an 'X', as their results can't really be evaluated since they're perfectly in-between!

Sample table of results: 

```{r, extdata}
exttable <- data %>% select(starts_with('EXT'))
exttable <- exttable %>% select(-c (ends_with('E'))) %>% 
  mutate(extscore = EXT1 - EXT2 + EXT3 - EXT4 + EXT5 - EXT6 + EXT7 - EXT8 + EXT9 - EXT10) %>% 
  mutate(extletter = 
    case_when(
      extscore > 0 ~ "S", 
      extscore < 0 ~ "R", 
      extscore == 0 ~ "X"
    )) %>%
  select(extscore, extletter, everything())
paged_table(head(exttable))

```

<br>
Visualizing this data into a graph: 


```{r, extgraph}
exttable <- data %>% select(starts_with('EXT'))
exttable <- exttable %>% select(-c (ends_with('E'))) %>% 
  mutate(extscore = (EXT1-3) - (EXT2-3) + (EXT3-3) - (EXT4-3) + (EXT5-3) - (EXT6-3) + (EXT7-3) - (EXT8-3) + (EXT9-3) - (EXT10-3)) %>% 
  mutate(extletter = 
    case_when(
      extscore > 0 ~ "S", 
      extscore < 0 ~ "R", 
      extscore == 0 ~ "X"
    ))

dfext <- data.frame(extlettercount = c(500346, 468068, 45144),
                    extlettermap = c('R', 'S', 'X'))


 pext <- ggplot(data=dfext, aes(x=extlettermap, y=extlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "More Users are Introverted Than Extroverted",
     subtitle = "Introverts, give me a cheer! Wait... why is it silent? Where did the introverts go?") + 
   xlab("Possible Results") +
   ylab("Amount of Users")+
   geom_text(aes(label=extlettercount), vjust=-0.3, size=3.5)+
   theme_minimal()
 pext

```


I'm going to refrain from any analysis on WHY there's more R's compared to S's until the final results. But, it's a pretty 50/50 split! 

The same process will be applied to the other personality traits^[The neuroticism table was actually calculated differently. For the other 4 traits, there were an equal number of 'positive (e.g. extroversion) questions' and 'negative (e.g. introversion) questions.' Neuroticism had 2 'positive' questions and 8 negative questions. So, subtracted 3 from each result, where a score of 5 (Agree) became +2, and a score of 1 (negative) became -2. This helped balance the questions, while using a similar process. I tried using this method with the other tables and got the same values as my previous method, which is good to see!], with the graphs of results located below: 

```{r, est}
 esttable <- data %>% select(starts_with('EST'))
 esttable <- esttable %>% select(-c (ends_with('E'))) %>%
   mutate(estscore = (EST2-3) - (EST1-3) - (EST3-3) + (EST4-3)  - (EST5-3)- (EST6-3)- (EST7-3)- (EST8-3)- (EST9-3)- (EST10-3)) %>%
   mutate(estletter =
            case_when(
              estscore > 0 ~ "C",
              estscore < 0 ~ "L",
              estscore == 0 ~ "X"
            ))
 
 dfest <- data.frame(estlettercount = c(517196, 452040, 44322),
                     estlettermap = c('L', 'C', 'X'))

 pest <- ggplot(data=dfest, aes(x=estlettermap, y=estlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "Users are More Prone to Being Limbic Than Calm",
     subtitle = "Moody and a little bit groovy") + 
   xlab("Possible Results") +
   ylab("Amount of Users")+
   geom_text(aes(label=estlettercount), vjust=-0.3, size=3.5)+
   theme_minimal()
 pest
```

```{r, csn}

 csntable <- data %>% select(starts_with('CSN'))
 csntable <- csntable %>% select(-c (ends_with('E'))) %>% 
   mutate(csnscore = (CSN1-3) - (CSN2-3) + (CSN3-3) - (CSN4-3) + (CSN5-3) - (CSN6-3) + (CSN7-3) - (CSN8-3) + (CSN9-3) - (CSN10-3)) %>% 
   mutate(csnletter = 
            case_when(
              csnscore > 0 ~ "O", 
              csnscore < 0 ~ "U", 
              csnscore == 0 ~ "X"
            ))

dfcsn <- data.frame(csnlettercount = c(614712, 339447, 59399),
                     csnlettermap = c('O', 'U', 'X'))
 
 pcsn <- ggplot(data=dfcsn, aes(x=csnlettermap, y=csnlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "Users Tend to be Organized, Rather Than Unorganized",
     subtitle = "Control freaks reign supreme") + 
   xlab("Possible Letters") +
   ylab("Amount of people")+
   geom_text(aes(label=csnlettercount), vjust=-0.3, size=3.5) +
   theme_minimal()
 pcsn
```

```{r, agr}
 agrtable <- data %>% select(starts_with('AGR'))
 agrtable <- agrtable %>% select(-c (ends_with('E'))) %>% 
   mutate(agrscore = AGR2 - AGR1 + AGR4 - AGR3 + AGR6 - AGR5 + AGR8 - AGR7 + AGR10 + AGR9) %>% 
   mutate(agrletter = 
            case_when(
              agrscore > 0 ~ "A", 
              agrscore < 0 ~ "E", 
              agrscore == 0 ~ "X"
            ))

dfagr <- data.frame(agrlettercount = c(836947, 138063, 38548),
                     agrlettermap = c('A', 'E', 'X'))
 
 pagr <- ggplot(data=dfagr, aes(x=agrlettermap, y=agrlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "Users Rate Themseleves More Agreeable Than Egocentric",
     subtitle = "AKA: People like to think they're a lot nicer than they actually are") + 
   xlab("Possible Letters") +
   ylab("Amount of people")+
   geom_text(aes(label=agrlettercount), vjust=-0.3, size=3.5) +
   theme_minimal()
 pagr
```

```{r, opn}
 opntable <- data %>% select(starts_with('OPN'))
 opntable <- opntable %>% select(-c (ends_with('E'))) %>% 
   mutate(opnscore = (OPN1-3) - (OPN2-3) + (OPN3-3) - (OPN4-3) + (OPN5-3) - (OPN6-3) + (OPN7-3) - (OPN8-3) + (OPN9-3) - (OPN10-3)) %>% 
   mutate(opnletter = 
            case_when(
              opnscore > 0 ~ "I", 
              opnscore < 0 ~ "N", 
              opnscore == 0 ~ "X"
            )) 

dfopn <- data.frame(opnlettercount = c(924641, 55789, 33128),
                     opnlettermap = c('I', 'N', 'X'))
 
 popn <- ggplot(data=dfopn, aes(x=opnlettermap, y=opnlettercount)) +
   geom_bar(stat="identity", fill="steel blue") +
   labs(
     title = "The Majourity Considers Themselves as Inquisitive",
     subtitle = "BREAKING NEWS: People like learning, schools are just ineffective... allegedly") + 
   xlab("Possible Letters") +
   ylab("Amount of people")+
   geom_text(aes(label=opnlettercount), vjust=-0.3, size=3.5) +
   theme_minimal()
 popn
```

After getting these values, we can now combine them together to get the results. I'm also going to limit this to the top 25 results... or else the data just gets super messy. 

```{r, combineresults}
finalletters <- c(paste(exttable$extletter, esttable$estletter, csntable$csnletter, agrtable$agrletter, opntable$opnletter, sep=""))
 finaltable <- data.frame(finalletters) 
  
 pfinaltable25 <- finaltable %>% 
   unnest(finalletters) %>%
   group_by(finalletters) %>%
   summarize(total = n()) %>%
   arrange(desc(total)) %>%
   slice(1:25)
 getPalette = colorRampPalette(brewer.pal(9, "Set1"))
 
  blank_theme <- theme_minimal()+
   theme(
     axis.title.x = element_blank(),
     axis.title.y = element_blank(),
   )
 
 bp25 <- ggplot(pfinaltable25, aes(x="", y=total, fill=reorder(finalletters, -total))) +
   geom_bar(width = 1, stat = "identity") +scale_fill_manual(values = getPalette(25))
 
 pie25 <- bp25 + coord_polar("y", start=0) 
 pie25 + blank_theme + theme(axis.text.x=element_blank()) +
   labs(title="25 Most Common Results", 
        fill="Results")
```

<br>
WOOO! Congratulations to the XXOAI family for being among the most common result out of 243 possibilities! If you'd prefer to see a more numerical visual, I've provided a table containing the 10 most common results below: 
<br>

```{r}

 pfinaltable <- finaltable %>% 
    unnest(finalletters) %>%
   group_by(finalletters) %>%
    summarize(total = n()) %>%
   arrange(desc(total)) %>%
   slice(1:10)
 
 pfinaltable <- pfinaltable %>% 
   mutate(percentage = total/1015342 * 100)

   
colnames(pfinaltable) <- c("Results", "Amount of Responses", "Percentage of People")
knitr::kable(pfinaltable,
             caption = "The 10 Most Common Results")
 
```

Let’s try to analyze these results. 

**Extrovertism** 

There seems to be a nice mix of S(ocial) and R(eserved) values, which is representative of the larger population. It’s the most balanced compared to the other 4 traits, and actually mirror what is expected. This is likely because it’s quite easy for oneself to decide if they’re ‘introverted’ or ‘extroverted’, and the questions (e.g. “I start conversations”) tended to be quite straight-forward and are experiences that they would’ve gone through in their daily life. 

When looking at TABLENUM, There are technically about 40000 more R’s than S’s. If I wanted to stereotype (which is an inevitable part of ‘absolute letters’, rather than 70% R vs 30% S), maybe the S’s aren’t as likely to spend 20 minutes on an online test, compared to R’s, who are more likely to be holed up in their room.  

**Neuroticism* *

Once again, a solid sample of results between C(alm) and L(imbic).  I think it’s similar to extrovertism, where it’s quite easy to determine how strongly you feel your emotions, and your ability to control them. 

Scrolling up to TABLENUM, there are more limbic people, compared to calm, by about 60000. I’m not really surprised, in fact, I’d think they’d be more limbic people, as society slowly puts more emphasis on mental health and actually exploring our emotions. This could make us more moody - we actually try to work through our emotions, rather than repressing them, and pretending to be calm. However, it could also be the other way around! By engaging with our emotions, we can better understand ourselves, and lead a life where we are calming since we build control!


**Conscientiousness**

Same as above, for O(rganized) and U(nstructured). Relatively simple to identify, applicable in daily life. 

There’s a lot more O’s than U’s, which I’m also surprised about? There’s also the most X’s in TABLENUM, compared to others. The X’s, I think, can be explained since people fluctuate between having super organized lives, but a messy desk? It’s easy to be both organized and unorganized. As for the large amount of O’s… It’s clearly not represented as much in TABLENUM, considering there’s basically an equal number of each response. It could be because people *want* to see themselves as organized, or they *think* they’re organized (e.g. they know where everything is on their desk, but items are actually strewn all over), when in reality, they aren’t! A good thought to carry for the next two personality traits.  

**Agreeableness** 

This is where it gets a bit funny! There is not a SINGLE E(gocentric) - it’s just a sea of A(greeable). This is probably because this is a self-administered test, people want to be seen as agreeable in society (correlated with ‘niceness’), and people are biased. 

Let me tell you a story that I heard from a TEDTalk. There’s this guy, I think he’s a magician, and he’s at the airport waiting. Something bad has happened that I can’t recall: Maybe his flight has been delayed by 2 hours, or he really needs a refund, or he’s lost his luggage. So, he calls their airline, and the customer representative is clearly in a bad mood, maybe a little bit angry or grouchy, and he’s getting nowhere with his request. The guy hears her voice, and realizes: “Oh, the representative must think that I’M so lucky (despite how she sounds) that I’M talking to her, because she’s taking SO MUCH TIME out of HER day to help me.” So, the guy goes “Hey! I really appreciate you for helping me, and I’m really grateful that I’m talking to you!” The flight attendant INSTANTLY is in a better mood, and becomes genuinely helpful, and ends up solving his request, after he acknowledges her struggles and actually is really kind to the flight attendant, who’s far more used to being yelled at! 

So, aside from being a heart-warming story, it also serves to prove two things: 

- People are biased. Most of the time, we think that WE’RE the good people, when we objectively aren’t.
- We like being liked. We can show this through helping others, as seen by the flight attendant’s resolve after being appreciated.

So, it makes sense why, if we’re inputting our own answers without requiring proof, people can naturally skew themselves into thinking that they’re nicer than they actually are. I think the same concept applies to agreeability - we like to think that we’re agreeable, because it’s correlated with niceness, and we like being nice. Not only that, but we want to be liked, and oftentimes, by agreeing with others, people have a nicer opinion of us!  Lastly, it’s a lot easier to agree with others, than to go against the status quo. Maybe people do disagree, but they’ve just repressed their own thoughts because… ~society~.^[I use agreeableness pretty synonymously with niceness. One can critique that isn’t the case, and that agreeability and niceness are more distinct than I make them out to be. That can absolutely be the case, and the story is not relevant. However, the point about society preferring agreeability still stands, and society will still influence how you act and how you perceive yourself.] The opposite also applies to egocentrism - nobody wants to call themselves egocentric, as it’s associated with narcissism and self-centeredness. They’re traits that nobody wants. Not only that, but who wants to admit that they agree with “I feel little concern for others.” 

**Openness** 

It’s anti-egocentrism part 2, except this time, people are refusing to call themselves non-inquisitive! In fact, it’s even worse than before, if you look at TABLENUM! Once again, it goes back to the same ideas: 

- People are biased, and that will significantly skew results if this is a self-administered quiz 
- People don’t like being seen as ‘non-inquisitive’, because it often has negative connotations relating to ‘not being smart’ or ‘being uninteresting’. The opposite can be said with people being seen as ‘inquisitive’. Who wants to admit that they’re NOT “quick to understand things.”

However, I think one major point that Openness has that Agreeability doesn’t, is just the fact that taking a Big Five personality quiz, inherently means that you’re going to be more inquisitive. If you weren’t curious about it in the first place, you just… wouldn’t take the quiz or care about the result. Hence, there’s some sample bias, as the people you’re getting results from, are already skewed towards inquisition. In addition, psychology is seen as something ‘nerdy’ and scientific, which caters to ‘smarter’ or ‘more educated’ audiences. 

Hence, someone might agree with “I have a rich vocabulary”, not because they’re interested in learning new words, but just because they perceive themselves as having a lot of knowledge due to their education. Or answer a 1 (disagree) to “I have difficulty understanding abstract ideas” or a 5 (agree) to “I am full of ideas”  because, through education, they’ve trained themselves to be better at comprehending abstract ideas or becoming better at brainstorming. 


**Sheer Statistical Impossibility...?** 

However, When analyzing this data, it seems.. strange that so many XXOAI types are represented. In fact, it feels weird that 15%(!!!!) of people were the EXACT SAME TYPE, despite ALL THE POSSIBILITIES! 

So, let's see how it compares to other, more theoritical, data. Using the data^[This was the only site that had theoretical values. I don't know where they got their percentages from, and there was also no data on certain combinations. It should also be noted that this site does not use 'X' as a possible result. E.g. XLUEI (or any combination with an 'X') is not considered. So this source can not be completely trusted. It should also be noted that SimilarMinds separated the theoretical values by female and male. Since this data set does not have this distinction, I used the average of the male and female theoretical values.] from [SimilarMinds](https://similarminds.com/global5/rcoai.html), we can see how our data stacks up. 


```{r}

 theorytable <- select(pfinaltable, Results) %>%
   mutate("Percentage of People" = c(3.4, 2.7, 3.5, "N/A", 2.4, 3.4, 3.5, "N/A", "N/A", "N/A"))

expertable <- select(pfinaltable, "Results", "Percentage of People")

# expertable <- knitr::kable(expertable,
#              caption = "Experimental")
# 
# theorytable <- knitr::kable(theorytable,
#              caption = "Theoretical")
#HOW DO I PUT THEM SIDE BY SIDE AND HAVE TITLES, better ways to add a title to table?

knitr::kable(list(theorytable,
             caption = "Theoretical", expertable,
             caption = "Experimental"))
```




Looking at these tables, there’s a clear discrepancy between theoretical and experimental data, where none of the theoretical results really match up to what is seen in our data set. However, most of it can be explained by the previous analysis: Wrong results might occur because of bias and societal norms (cementing the last two letters to be A and I), in addition to the natural disposition of responders. This comparison really just showcases how there’s a high likelihood of bias. 

Honestly, I’m not too sure why 15% of people are SCOAI, maybe people are being influenced to answer what they WANT to be like, rather than what they actually are, since SCOAI seems like one of the most 'socially-successful’ results. But, in reality, responders aren’t actually SCOAIs. That’s my best guess!^[If you have more ideas, I’d love to hear them! Reach out :)]

Also, if you're interested, here's a list of the most uncommon results! 

```{r, unpoptable}
pfinaltableasc <- finaltable %>% 
  unnest(finalletters) %>%
  group_by(finalletters) %>%
  summarize(total = n()) %>%
  arrange(total) %>%
  slice(1:10)

colnames(pfinaltableasc) <- c("Results", "Amount of Responses")

knitr::kable(pfinaltableasc,
             caption = "Most Uncommon Results")

```

No surprise, it's a lot of results with X's. It's pretty hard to get an X, because you're perfectly in between! 

At first, I was surprised that 'XXXXX' didn't appear, since it's technically the most unlikely.^[There's actually 3794 results for XXXXX] However, I wouldn't be surprised if only 5% of those results were genuine user responses, and the other 95% were just people who kept clicking 3 (Neutral), or had some kind of game to see if they could perfectly answered the questions to get XXXXX. 

### Do results vary between countries? <a name="country"></a>



<!--

home drop down menu -> home (about) and analysis with intro, data, and further analysis 
- get through data, start research for further analysis 
-->